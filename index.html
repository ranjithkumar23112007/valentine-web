<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Happy Valentine's Day üíñ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-storage.js"></script>
<style>
    body {
        margin: 0;
        padding: 0;
        background: linear-gradient(to right, #ff9a9e, #fecfef);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        font-family: Arial, sans-serif;
        flex-direction: column;
        padding: 20px;
    }

    body.celebration {
        background: #000;
        overflow: hidden;
    }

    .main-heart {
        position: relative;
        width: 120px;
        height: 120px;
        background: red;
        transform: rotate(-45deg);
        animation: beat 1s infinite;
        margin-bottom: 30px;
    }

    .main-heart::before,
    .main-heart::after {
        content: "";
        position: absolute;
        width: 120px;
        height: 120px;
        background: red;
        border-radius: 50%;
    }

    .main-heart::before {
        top: -60px;
        left: 0;
    }

    .main-heart::after {
        left: 60px;
        top: 0;
    }

    @keyframes beat {
        0%, 100% { transform: scale(1) rotate(-45deg); }
        50% { transform: scale(1.2) rotate(-45deg); }
    }

    h1 {
        color: white;
        text-shadow: 2px 2px 5px #d6336c;
        text-align: center;
        font-size: 24px;
    }

    @media (min-width: 768px) {
        h1 {
            font-size: 32px;
        }
    }

    button {
        padding: 10px 20px;
        border: none;
        border-radius: 20px;
        background: #ff4d6d;
        color: white;
        font-size: 14px;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        transition: background 0.3s;
    }

    @media (min-width: 768px) {
        button {
            font-size: 16px;
            padding: 12px 24px;
        }
    }

    button:hover {
        background: #e63956;
    }

    /* gallery styles */
    .gallery-section {
        margin-top: 30px;
        text-align: center;
    }

    .gallery-container {
        display: flex;
        gap: 20px;
        align-items: center;
        flex-wrap: wrap;
        justify-content: center;
        position: relative;
    }

    @media (min-width: 768px) {
        .gallery-container {
            gap: 50px;
        }
    }

    /* heart shaped photo containers - using SVG shape */
    .heart-photo-box {
        position: relative;
        width: 160px;
        height: 190px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    @media (min-width: 768px) {
        .heart-photo-box {
            width: 240px;
            height: 280px;
        }
    }

    .heart-photo-box svg {
        position: absolute;
        width: 100%;
        height: 100%;
        filter: drop-shadow(0 6px 15px rgba(0,0,0,0.15));
    }

    .heart-photo-box img {
        position: relative;
        z-index: 2;
        width: 130px;
        height: 160px;
        object-fit: cover;
        object-position: center 35%;
        border-radius: 12px;
    }

    @media (min-width: 768px) {
        .heart-photo-box img {
            width: 200px;
            height: 240px;
            border-radius: 20px;
        }
    }

    .heart-photo-box.empty {
        background: rgba(255, 255, 255, 0.3);
        border: 2px dashed white;
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 50px;
    }

    /* center heart */
    .center-heart {
        position: relative;
        width: 60px;
        height: 60px;
        background: red;
        transform: rotate(-45deg);
        animation: beat 1s infinite;
        flex-shrink: 0;
    }

    @media (min-width: 768px) {
        .center-heart {
            width: 100px;
            height: 100px;
        }
    }

    .center-heart::before,
    .center-heart::after {
        content: "";
        position: absolute;
        width: 100px;
        height: 100px;
        background: red;
        border-radius: 50%;
    }

    .center-heart::before {
        top: -30px;
        left: 0;
        width: 60px;
        height: 60px;
    }

    .center-heart::after {
        left: 30px;
        top: 0;
        width: 60px;
        height: 60px;
    }

    @media (min-width: 768px) {
        .center-heart::before {
            top: -50px;
            left: 0;
            width: 100px;
            height: 100px;
        }

        .center-heart::after {
            left: 50px;
            top: 0;
            width: 100px;
            height: 100px;
        }
    }

    /* cracker burst animation */
    .cracker {
        position: fixed;
        pointer-events: none;
        font-size: 30px;
        animation: crackerBurst 1.2s ease-out forwards;
    }

    @keyframes crackerBurst {
        0% {
            opacity: 1;
            transform: translate(0, 0) scale(1);
        }
        100% {
            opacity: 0;
            transform: translate(var(--tx), var(--ty)) scale(0.3);
        }
    }

    /* upload controls */
    .upload-controls {
        margin-top: 15px;
        display: flex;
        gap: 8px;
        align-items: center;
        flex-wrap: wrap;
        justify-content: center;
        background: rgba(255, 255, 255, 0.1);
        padding: 12px;
        border-radius: 12px;
        font-size: 12px;
    }

    @media (min-width: 768px) {
        .upload-controls {
            gap: 12px;
            padding: 15px;
            font-size: 14px;
        }
    }

    .upload-controls input[type="file"] {
        padding: 6px;
        border-radius: 6px;
        border: 2px solid white;
        cursor: pointer;
        color: white;
        font-size: 11px;
    }

    @media (min-width: 768px) {
        .upload-controls input[type="file"] {
            padding: 8px;
            border-radius: 8px;
            font-size: 14px;
        }
    }

    .visually-hidden {
        position: absolute !important;
        height: 1px; width: 1px;
        overflow: hidden;
        clip: rect(1px, 1px, 1px, 1px);
        white-space: nowrap;
    }

    /* Question Section Styles */
    .question-section {
        display: none;
        text-align: center;
        background: rgba(255, 255, 255, 0.2);
        padding: 40px;
        border-radius: 20px;
        margin-top: 30px;
        backdrop-filter: blur(10px);
    }

    .question-section.active {
        display: block;
    }

    .question-section h2 {
        color: white;
        font-size: 20px;
        margin-bottom: 15px;
        text-shadow: 2px 2px 5px #d6336c;
    }

    @media (min-width: 768px) {
        .question-section h2 {
            font-size: 28px;
            margin-bottom: 20px;
        }
    }

    .question-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
    }

    .question-buttons button {
        padding: 12px 24px;
        font-size: 14px;
        font-weight: bold;
        transition: all 0.3s ease;
    }

    @media (min-width: 768px) {
        .question-buttons button {
            padding: 15px 40px;
            font-size: 18px;
        }
    }

    .yes-btn {
        background: #00d084;
    }

    .yes-btn:hover {
        background: #00b870;
        transform: scale(1.05);
    }

    .no-btn {
        background: #ff6b9d;
    }

    .no-btn:hover {
        background: #ff4a7e;
        transform: scale(1.05);
    }

    /* Share Section */
    .share-section {
        display: none;
        text-align: center;
        background: rgba(255, 255, 255, 0.2);
        padding: 20px;
        border-radius: 12px;
        margin-top: 20px;
    }

    .share-section.active {
        display: block;
    }

    .share-buttons {
        display: flex;
        gap: 10px;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 15px;
    }

    .share-btn {
        padding: 10px 20px;
        border: none;
        border-radius: 12px;
        background: #fff;
        color: #ff4d6d;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
    }

    .share-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(0,0,0,0.2);
    }

    /* Celebration Confetti */
    .celebration-confetti {
        position: fixed;
        pointer-events: none;
        font-size: 40px;
        animation: celebrationBurst 3s ease-in forwards;
        z-index: 9999;
    }

    @keyframes celebrationBurst {
        0% {
            opacity: 1;
            transform: translate(0, 0) rotateZ(0deg) scale(1);
        }
        50% {
            opacity: 1;
        }
        100% {
            opacity: 0;
            transform: translate(var(--tx), var(--ty)) rotateZ(360deg) scale(0);
        }
    }

    /* Hide sections after celebration */
    body.celebration .main-content {
        display: none;
    }

    .celebration-message {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #ffeb3b;
        font-size: 60px;
        font-weight: bold;
        text-shadow: 2px 2px 10px rgba(0,0,0,0.8);
        z-index: 10000;
        text-align: center;
        animation: messageFloat 2s ease-in-out;
    }

    body.celebration .celebration-message {
        display: block;
    }

    @keyframes messageFloat {
        0% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.5);
        }
        50% {
            opacity: 1;
        }
        100% {
            opacity: 0;
            transform: translate(-50%, -150%) scale(1);
        }
    }

    /* Heart indicator above gallery */
    .heart-indicator {
        font-size: 60px;
        text-align: center;
        margin-bottom: 15px;
        opacity: 0;
        transition: opacity 0.5s ease;
        animation: heartPulse 0.8s ease-in-out;
    }

    .heart-indicator.show {
        opacity: 1;
    }

    @keyframes heartPulse {
        0% {
            opacity: 0;
            transform: scale(0.3);
        }
        50% {
            opacity: 1;
            transform: scale(1.2);
        }
        100% {
            opacity: 1;
            transform: scale(1);
        }
    }
</style>
</head>
<body>

<div class="main-content">
    <div class="main-heart" aria-hidden="true"></div>

    <h1 id="message">Happy Valentine's Day üíñ</h1>

    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
        <button onclick="setName()">Personalize Message</button>
        <button id="shareBtn" onclick="shareWithPersonalization()" style="background: #4CAF50; display: none;">üì§ Share with Friend</button>
    </div>

<script>
// üî• FIREBASE SETUP - UPDATE THESE WITH YOUR FIREBASE CREDENTIALS
// Get these from: https://console.firebase.google.com/
const firebaseConfig = {
    apiKey: "AIzaSyDemoKeyPleaseUpdateThis", // Replace with your API Key
    authDomain: "your-project.firebaseapp.com", // Replace with your domain
    databaseURL: "https://your-project-default-rtdb.firebaseio.com", // Replace with your database URL
    projectId: "your-project-id", // Replace with your project ID
    storageBucket: "your-project.appspot.com", // Replace with your storage bucket
    messagingSenderId: "123456789", // Replace with your sender ID
    appId: "1:123456789:web:abcdef123456" // Replace with your app ID
};

// Initialize Firebase
let db, storage;
try {
    firebase.initializeApp(firebaseConfig);
    db = firebase.database();
    storage = firebase.storage();
    console.log("‚úÖ Firebase initialized successfully!");
} catch(e) {
    console.warn("‚ö†Ô∏è Firebase not configured - using local storage fallback. Please update firebaseConfig!");
}

// Generate or get unique session ID
function getSessionId() {
    let sessionId = localStorage.getItem('valentineSessionId');
    if(!sessionId) {
        sessionId = 'valentine_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('valentineSessionId', sessionId);
    }
    return sessionId;
}

const sessionId = getSessionId();
const dbRef = db ? db.ref('valentines/' + sessionId) : null;

function setName() {
    let name = prompt("Enter your Valentine's name üíå");
    if(name) {
        document.getElementById("message").innerText =
            "Happy Valentine's Day, " + name + " üíñ";
        // Save to Firebase
        if(dbRef) dbRef.child('name').set(name);
    }
}

// Load name from URL on page load
function loadNameFromURL() {
    const params = new URLSearchParams(window.location.search);
    const sharedName = params.get('name');
    const sharedSessionId = params.get('sid');
    
    if(sharedSessionId && dbRef) {
        // Load from Firebase using shared session ID
        const sharedRef = db.ref('valentines/' + sharedSessionId);
        sharedRef.once('value').then(snapshot => {
            if(snapshot.exists()) {
                const data = snapshot.val();
                if(data.name) {
                    document.getElementById("message").innerText =
                        "Happy Valentine's Day, " + data.name + " üíñ";
                }
                // Merge the images into localStorage for this view
                if(data.image1Url) localStorage.setItem('valentineImage1', data.image1Url);
                if(data.image2Url) localStorage.setItem('valentineImage2', data.image2Url);
                if(data.answer) localStorage.setItem('valentineAnswer', data.answer);
                loadSavedImages();
            }
        }).catch(err => console.log("Could not load from Firebase:", err));
    } else if(sharedName) {
        const decodedName = decodeURIComponent(sharedName);
        document.getElementById("message").innerText =
            "Happy Valentine's Day, " + decodedName + " üíñ";
    }
}

// Load saved images
function loadSavedImages() {
    const savedImage1 = localStorage.getItem('valentineImage1');
    const savedImage2 = localStorage.getItem('valentineImage2');
    const savedAnswer = localStorage.getItem('valentineAnswer');
    
    if(savedImage1) {
        const heartBox1 = document.getElementById('heart-box-1');
        heartBox1.classList.remove('empty');
        heartBox1.innerHTML = '<svg viewBox="0 0 240 280" preserveAspectRatio="none" style="fill: red;"><path d="M 120 280 C 60 240 20 200 20 140 C 20 100 50 70 90 70 C 110 70 130 80 120 100 C 110 80 130 70 150 70 C 190 70 220 100 220 140 C 220 200 180 240 120 280 Z"/></svg><img src="' + savedImage1 + '" alt="First Valentine photo">';
    }
    
    if(savedImage2) {
        const heartBox2 = document.getElementById('heart-box-2');
        heartBox2.classList.remove('empty');
        heartBox2.innerHTML = '<svg viewBox="0 0 240 280" preserveAspectRatio="none" style="fill: red;"><path d="M 120 280 C 60 240 20 200 20 140 C 20 100 50 70 90 70 C 110 70 130 80 120 100 C 110 80 130 70 150 70 C 190 70 220 100 220 140 C 220 200 180 240 120 280 Z"/></svg><img src="' + savedImage2 + '" alt="Second Valentine photo">';
    }
    
    if(savedAnswer) {
        const heartIndicator = document.getElementById('heartIndicator');
        heartIndicator.textContent = savedAnswer === 'yes' ? '‚ù§Ô∏è' : 'ü§ç';
        heartIndicator.style.display = 'block';
        heartIndicator.classList.add('show');
    }
    
    if(savedImage1 && savedImage2) {
        document.getElementById('shareBtn').style.display = 'inline-block';
        if(!savedAnswer) {
            setTimeout(() => {
                document.getElementById('questionSection').classList.add('active');
            }, 500);
        } else {
            document.getElementById('shareSection').classList.add('active');
        }
    }
}

window.addEventListener('load', function() {
    loadNameFromURL();
    loadSavedImages();
});

function shareWithPersonalization() {
    const messageText = document.getElementById("message").innerText;
    const nameMatch = messageText.match(/Happy Valentine's Day, (.+) üíñ/);
    const name = nameMatch ? nameMatch[1] : "";
    
    const savedImage1 = localStorage.getItem('valentineImage1');
    const savedImage2 = localStorage.getItem('valentineImage2');
    
    if(!name || name === "") {
        alert("Please set a personalized name first by clicking 'Personalize Message'! üíå");
        return;
    }
    
    if(!savedImage1 || !savedImage2) {
        alert("Please add both photos first by clicking 'Add Your Photos'! üì∏");
        return;
    }
    
    const currentUrl = window.location.href.split('?')[0];
    const shareUrl = currentUrl + "?name=" + encodeURIComponent(name) + "&sid=" + sessionId;
    
    navigator.clipboard.writeText(shareUrl).then(() => {
        alert(`‚ú® Link copied! When your friend opens it, they'll see:\n\n"Happy Valentine's Day, ${name} üíñ"\n\n+ Your 2 photos will be displayed!\n\nShare this link with them now! üíï`);
    }).catch(() => {
        alert(`Share this link:\n${shareUrl}`);
    });
}
</script>


    <div class="gallery-section">
        <div id="heartIndicator" class="heart-indicator" style="display: none;">‚ù§Ô∏è</div>
        
        <div class="upload-controls" aria-label="Add your photos">
            <label for="upload1" class="visually-hidden">Upload first photo</label>
            <input id="upload1" type="file" accept="image/*" aria-label="Choose first image to upload">
            <label for="upload2" class="visually-hidden">Upload second photo</label>
            <input id="upload2" type="file" accept="image/*" aria-label="Choose second image to upload">
            <button id="addPhotos">Add Your Photos</button>
        </div>

        <div class="gallery-container" aria-live="polite" aria-label="Photo gallery">
            <!-- First heart-shaped photo placeholder -->
            <div class="heart-photo-box empty" id="heart-box-1">
                <svg viewBox="0 0 240 280" preserveAspectRatio="none" style="fill: rgba(255, 255, 255, 0.3); stroke: white; stroke-width: 2;">
                    <path d="M 120 280 C 60 240 20 200 20 140 C 20 100 50 70 90 70 C 110 70 130 80 120 100 C 110 80 130 70 150 70 C 190 70 220 100 220 140 C 220 200 180 240 120 280 Z"/>
                </svg>
                <span>üíï</span>
            </div>

            <!-- Center beating heart -->
            <div class="center-heart" aria-hidden="true"></div>

            <!-- Second heart-shaped photo placeholder -->
            <div class="heart-photo-box empty" id="heart-box-2">
                <svg viewBox="0 0 240 280" preserveAspectRatio="none" style="fill: rgba(255, 255, 255, 0.3); stroke: white; stroke-width: 2;">
                    <path d="M 120 280 C 60 240 20 200 20 140 C 20 100 50 70 90 70 C 110 70 130 80 120 100 C 110 80 130 70 150 70 C 190 70 220 100 220 140 C 220 200 180 240 120 280 Z"/>
                </svg>
                <span>üíï</span>
            </div>
        </div>
    </div>

    <!-- Question Section -->
    <div class="question-section" id="questionSection">
        <h2>Will you be my Valentine? üíï</h2>
        <div class="question-buttons">
            <button class="yes-btn" onclick="handleYes()">YES! üíö</button>
            <button class="no-btn" onclick="handleNo()">Maybe Later üòä</button>
        </div>
    </div>

    <!-- Share Section -->
    <div class="share-section" id="shareSection">
        <h3 style="color: white; margin-bottom: 10px;">Share with your friend! üíå</h3>
        <div class="share-buttons">
            <button class="share-btn" onclick="shareViaMessage()">üì± Send Message</button>
            <button class="share-btn" onclick="shareViaLink()">üîó Copy Link</button>
            <button class="share-btn" onclick="shareViaOther()">üì§ Share More</button>
        </div>
    </div>
</div>

<div class="celebration-message">YES! YOU'RE MY VALENTINE! üíïüéâ</div>

<script>
function createCrackerBurst(x, y) {
    const crackerEmojis = ['üéÜ', '‚ú®', 'üí•', '‚≠ê', 'üåü', 'üí´'];
    const numCrackers = 15;
    
    for (let i = 0; i < numCrackers; i++) {
        const cracker = document.createElement('div');
        cracker.className = 'cracker';
        cracker.textContent = crackerEmojis[Math.floor(Math.random() * crackerEmojis.length)];
        
        const angle = (i / numCrackers) * Math.PI * 2;
        const distance = 100 + Math.random() * 50;
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance;
        
        cracker.style.left = x + 'px';
        cracker.style.top = y + 'px';
        cracker.style.setProperty('--tx', tx + 'px');
        cracker.style.setProperty('--ty', ty + 'px');
        
        document.body.appendChild(cracker);
        
        setTimeout(() => cracker.remove(), 1200);
    }
}

function createFullScreenCelebration() {
    document.body.classList.add('celebration');
    
    const celebrationEmojis = ['üéÜ', '‚ú®', 'üí•', '‚≠ê', 'üåü', 'üí´', 'üéâ', 'üéä', 'üíï', '‚ù§Ô∏è', 'ü•≥'];
    
    // Create continuous confetti burst
    for (let burst = 0; burst < 8; burst++) {
        setTimeout(() => {
            for (let i = 0; i < 25; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'celebration-confetti';
                confetti.textContent = celebrationEmojis[Math.floor(Math.random() * celebrationEmojis.length)];
                
                const angle = (Math.random() * Math.PI * 2);
                const distance = 150 + Math.random() * 200;
                const tx = Math.cos(angle) * distance;
                const ty = Math.sin(angle) * distance - 200;
                
                const x = window.innerWidth / 2 + (Math.random() - 0.5) * window.innerWidth;
                const y = window.innerHeight / 2;
                
                confetti.style.left = x + 'px';
                confetti.style.top = y + 'px';
                confetti.style.setProperty('--tx', tx + 'px');
                confetti.style.setProperty('--ty', ty + 'px');
                
                document.body.appendChild(confetti);
                
                setTimeout(() => confetti.remove(), 3000);
            }
        }, burst * 400);
    }
}

function handleYes() {
    // Save answer to localStorage and Firebase
    localStorage.setItem('valentineAnswer', 'yes');
    if(dbRef) dbRef.child('answer').set('yes');
    
    // Show red heart indicator
    const heartIndicator = document.getElementById('heartIndicator');
    heartIndicator.textContent = '‚ù§Ô∏è';
    heartIndicator.style.display = 'block';
    heartIndicator.classList.add('show');
    
    createFullScreenCelebration();
    setTimeout(() => {
        document.getElementById('questionSection').style.display = 'none';
        showShareSection();
    }, 2000);
}

function handleNo() {
    // Save answer to localStorage and Firebase
    localStorage.setItem('valentineAnswer', 'no');
    if(dbRef) dbRef.child('answer').set('no');
    
    // Show white heart indicator
    const heartIndicator = document.getElementById('heartIndicator');
    heartIndicator.textContent = 'ü§ç';
    heartIndicator.style.display = 'block';
    heartIndicator.classList.add('show');
    
    const noBtn = document.querySelector('.no-btn');
    noBtn.textContent = 'Maybe next year? üíù';
    setTimeout(() => {
        showShareSection();
    }, 800);
}

function showShareSection() {
    document.getElementById('shareSection').classList.add('active');
}

function getShareUrl() {
    const messageText = document.getElementById("message").innerText;
    const nameMatch = messageText.match(/Happy Valentine's Day, (.+) üíñ/);
    const name = nameMatch ? nameMatch[1] : "";
    
    const currentUrl = window.location.href.split('?')[0];
    if(name && name !== "") {
        return currentUrl + "?name=" + encodeURIComponent(name);
    }
    return currentUrl;
}

function shareViaMessage() {
    const shareUrl = getShareUrl();
    const messageText = document.getElementById("message").innerText;
    const nameMatch = messageText.match(/Happy Valentine's Day, (.+) üíñ/);
    const name = nameMatch ? nameMatch[1] : "";
    
    const message = encodeURIComponent(`Check out my Valentine! Will you be my Valentine, ${name}? üíï\n${shareUrl}`);
    window.open("sms:?body=" + message, "_blank");
    alert("Message will be sent with the link!");
}

function shareViaLink() {
    const shareUrl = getShareUrl();
    const messageText = document.getElementById("message").innerText;
    const nameMatch = messageText.match(/Happy Valentine's Day, (.+) üíñ/);
    const name = nameMatch ? nameMatch[1] : "";
    
    navigator.clipboard.writeText(shareUrl).then(() => {
        if(name && name !== "") {
            alert(`‚ú® Link copied with personalized name!\n\nWhen your friend opens it, they'll see:\n"Happy Valentine's Day, ${name} üíñ"\n+ Your beautiful photos!\n\nNow share it! üíå`);
        } else {
            alert("Link copied to clipboard! Now you can paste it anywhere to share with your friend üíå");
        }
    }).catch(() => {
        alert("Link: " + shareUrl + "\n\nCopy this and share it with your friend!");
    });
}

function shareViaOther() {
    const shareUrl = getShareUrl();
    const messageText = document.getElementById("message").innerText;
    const nameMatch = messageText.match(/Happy Valentine's Day, (.+) üíñ/);
    const name = nameMatch ? nameMatch[1] : "";
    
    const title = name ? `Will you be my Valentine, ${name}?` : "Will you be my Valentine?";
    const text = name ? `Happy Valentine's Day, ${name}! üíï` : "Check out my Valentine request! üíï";
    
    if (navigator.share) {
        navigator.share({
            title: title,
            text: text,
            url: shareUrl
        }).catch(() => {});
    } else {
        alert("Share this link with your friend:\n" + shareUrl);
    }
}

document.getElementById('addPhotos').addEventListener('click', function () {
    const fileInput1 = document.getElementById('upload1');
    const fileInput2 = document.getElementById('upload2');
    const heartBox1 = document.getElementById('heart-box-1');
    const heartBox2 = document.getElementById('heart-box-2');

    if (!fileInput1.files || fileInput1.files.length === 0) {
        alert('Please choose first photo to upload');
        return;
    }

    if (!fileInput2.files || fileInput2.files.length === 0) {
        alert('Please choose second photo to upload');
        return;
    }

    const file1 = fileInput1.files[0];
    const file2 = fileInput2.files[0];

    if (!file1.type.startsWith('image/') || !file2.type.startsWith('image/')) {
        alert('Please choose valid image files');
        return;
    }

    // Load first image
    const reader1 = new FileReader();
    reader1.onload = function (e) {
        const imageData = e.target.result;
        localStorage.setItem('valentineImage1', imageData);
        
        // Save to Firebase if available
        if(dbRef) dbRef.child('image1Url').set(imageData);
        
        heartBox1.classList.remove('empty');
        heartBox1.innerHTML = '<svg viewBox="0 0 240 280" preserveAspectRatio="none" style="fill: red;"><path d="M 120 280 C 60 240 20 200 20 140 C 20 100 50 70 90 70 C 110 70 130 80 120 100 C 110 80 130 70 150 70 C 190 70 220 100 220 140 C 220 200 180 240 120 280 Z"/></svg><img src="' + imageData + '" alt="First Valentine photo">';
        
        const rect1 = heartBox1.getBoundingClientRect();
        const centerX1 = rect1.left + rect1.width / 2;
        const centerY1 = rect1.top + rect1.height / 2;
        createCrackerBurst(centerX1, centerY1);
    };
    reader1.readAsDataURL(file1);

    // Load second image
    const reader2 = new FileReader();
    reader2.onload = function (e) {
        const imageData = e.target.result;
        localStorage.setItem('valentineImage2', imageData);
        
        // Save to Firebase if available
        if(dbRef) dbRef.child('image2Url').set(imageData);
        
        heartBox2.classList.remove('empty');
        heartBox2.innerHTML = '<svg viewBox="0 0 240 280" preserveAspectRatio="none" style="fill: red;"><path d="M 120 280 C 60 240 20 200 20 140 C 20 100 50 70 90 70 C 110 70 130 80 120 100 C 110 80 130 70 150 70 C 190 70 220 100 220 140 C 220 200 180 240 120 280 Z"/></svg><img src="' + imageData + '" alt="Second Valentine photo">';
        
        const rect2 = heartBox2.getBoundingClientRect();
        const centerX2 = rect2.left + rect2.width / 2;
        const centerY2 = rect2.top + rect2.height / 2;
        createCrackerBurst(centerX2, centerY2);
        
        // Show question section and share button after both images are loaded
        setTimeout(() => {
            document.getElementById('questionSection').classList.add('active');
            document.getElementById('shareBtn').style.display = 'inline-block';
        }, 1500);
    };
    reader2.readAsDataURL(file2);
});
</script>

</body>
</html>
